---
layout: post
title: Version-Control - Git
tags: "é€šç”¨"
comments: 1
excerpt: å…³äºGitçš„ç¬”è®°ã€‚
typora-root-url: ..\..\..
typora-copy-images-to: ..\..\..\assets\blog_res\git
---



## åŸºæœ¬ç–é€š Walkthrough 

### å®‰è£…Git

åœ¨è¿™ä¸ª[å®˜ç½‘]( https://git-scm.com/downloads)å¯ä»¥ä¸‹è½½åˆ°æœ€æ–°ç‰ˆæœ¬å¾—Gitã€‚åœ¨ä¸‹è½½å¹¶ç‚¹å‡»å®‰è£…åï¼Œä¸‹é¢æ˜¯å€¼å¾—å…³æ³¨çš„ç‚¹ï¼š

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131850704.png)ä½¿ç”¨ notepad++ å½“ç¼–è¾‘å™¨

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131851881.png)ä¸€ä¸ªæ–° repository é»˜è®¤åˆ†æ”¯å«ä»€ä¹ˆåç§°ã€‚Github ç”¨çš„æ˜¯ mainï¼Œgit é»˜è®¤çš„æ˜¯ masterã€‚ç›¸å…³è®¨è®ºå‚è€ƒ[æ­¤å¤„](https://stackoverflow.com/questions/64249491/difference-between-main-branch-and-master-branch-in-github)ã€‚

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131851309.png)å›è½¦ç¬¦çš„è®¾ç½®å¦‚å›¾æ‰€ç¤ºæœ‰ä¸‰ç§

1. æ‹‰æ–‡ä»¶ä¸‹æ¥æ—¶å€™ LF=>CRLFï¼Œcommitä¸Šå»æ—¶ï¼Œä¼š CRLF=>LFã€‚window ç¯å¢ƒä½¿ç”¨ã€‚
2. commitä¸Šå»æ—¶ï¼Œä¼š CRLF=>LFï¼ˆå¦‚æœæ˜¯CRLFçš„æ—¶å€™ï¼‰ã€‚unix ç¯å¢ƒæ—¶å€™ã€‚
3. è¿ commitæ—¶å€™ä¹Ÿä¸åšä»»ä½•çš„è½¬æ¢

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131855660.png)å½“ `git pull` å‘ç”Ÿå†²çªæ—¶ï¼Œé€‰æ‹©çš„ç­–ç•¥ï¼š

1. merge
2. rebase
3. ä»€ä¹ˆéƒ½ä¸åš

è¿™é‡Œé€‰æ‹© rebase ï¼Œåªè¿›è¡Œä¸€æ¬¡ mergeã€‚å¤šæ¬¡ merge æ„ä¹‰ä¸å¤§ã€‚

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131856362.png)

credential helperï¼ˆå­˜å‚¨å‡­è¯çš„å·¥å…·ï¼‰

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131856025.png)

### Using HTTPS

1. ä¸‹è½½ä»“åº“ Clone from a remote Repository

   ```bash
   $ git clone https://github.com/caliburn1994/git_practice.git
   Cloning into 'git_practice'...
   remote: Enumerating objects: 17, done.
   remote: Counting objects: 100% (17/17), done.
   remote: Compressing objects: 100% (11/11), done.
   remote: Total 17 (delta 4), reused 0 (delta 0), pack-reused 0
   Receiving objects: 100% (17/17), done.
   $ cd git_practice/ # æœ¬æ¬¡ç¤ºä¾‹ä½¿ç”¨çš„ä»“åº“
   ```

3. åˆ›å»ºåˆ†æ”¯å¹¶åˆ‡æ¢ï¼Œå¹¶æ¨é€

   ```shell
   $ git checkout -b iss53
   Switched to a new branch 'iss53'
   ```

4. å½“è¾“å…¥ `git push` å‘½ä»¤æ—¶ï¼ŒGithubå°†ä¼šå¼¹æ¡†å¹¶è¦æ±‚è¾“å…¥Access Token

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131857217.png)åœ¨ GitHub çš„ setting é‡Œç”Ÿæˆ access tokenï¼ˆå¦‚å›¾æ‰€ç¤ºçš„ä½ç½®ï¼‰ ï¼Œå¹¶è¾“å…¥ token åˆ°è¾“å…¥æ¡†ã€‚

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131857434.png)ç™»é™†å

   ```
   $ git push --set-upstream origin iss53
   Total 0 (delta 0), reused 0 (delta 0), pack-reused 0
   remote:
   remote: Create a pull request for 'iss53' on GitHub by visiting:
   remote:      https://github.com/caliburn1994/git_practice/pull/new/iss53
   remote:
   To https://github.com/caliburn1994/git_practice.git
    * [new branch]      iss53 -> iss53
   Branch 'iss53' set up to track remote branch 'iss53' from 'origin'.
   ```
   
5. æäº¤æ–‡ä»¶

   ```bash
   $ echo "# Java-Demo" >> README.md
   $ git add README.md
   $ git commit -m "first commit"
   [iss53 aaefaf0] first commit
    1 file changed, 1 insertion(+), 1 deletion(-)
   $ git push
   Enumerating objects: 5, done.
   Counting objects: 100% (5/5), done.
   Delta compression using up to 8 threads
   Compressing objects: 100% (2/2), done.
   Writing objects: 100% (3/3), 285 bytes | 285.00 KiB/s, done.
   Total 3 (delta 1), reused 0 (delta 0), pack-reused 0
   remote: Resolving deltas: 100% (1/1), completed with 1 local object.
   To https://github.com/caliburn1994/git_practice.git
      f35536a..aaefaf0  iss53 -> iss53
   ```

PSï¼š

- è¾“å…¥çš„ token å°†å­˜åœ¨ Credential Manager ä¸­ã€‚[^1]

### Using SourceTree + SSH

1. é€šè¿‡ PuTTY ç”Ÿæˆ public key å’Œ private key

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131857295.png)ä¿å­˜ OpenSSH æ ¼å¼çš„ private key è‡³ `~/.ssh/github.ppk`

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131857692.png)å¤åˆ¶ OpenSSH æ ¼å¼çš„ public key 

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131858819.png)Github çš„ SSH and GPG keys é‡Œæ–°åˆ›å»ºä¸€ä¸ª SSH keyï¼Œå¹¶é»è´´åˆšåˆšçš„ public key

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131858980.png)SSH-agent æ·»åŠ  private key

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131858474.png)ç™»å½•å

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131859691.png)æµ‹è¯•ï¼ˆclone a repository )

   ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131859236.png)Using SSH


å½“æˆ‘ä»¬é€šè¿‡ clone ä¸‹è½½é¡¹ç›®ï¼Œå°†ä¼šè¢«æ‹’ç»ï¼ŒåŸå› æ˜¯æ²¡æœ‰ public keyã€‚

```bash
$ git clone git@github.com:caliburn1994/git_practice.git
Cloning into 'git_practice'...
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
```

å†ä½¿ç”¨ putty ç”Ÿæˆ key pair ä¹‹åï¼Œ

```bash
$ ls ~/.ssh
github  github.openssh  github.ppk  known_hosts
```

ç„¶åç»§ç»­åœ¨ GitHub æ·»åŠ  SSH key (å‚è€ƒä½¿ç”¨ [Using SourceTree + SSH](#Using SourceTree + SSH))

```bash
cat << EOF > ~/.ssh/config
Host github.com
    User git
    Hostname github.com
    IdentityFile ~/.ssh/github.ppk
    Port 22
    IdentitiesOnly yes
EOF
```

æµ‹è¯•

```
$ ssh -T github.com
Hi caliburn1994! You've successfully authenticated, but GitHub does not provide shell access.
$ git clone git@github.com:caliburn1994/git_practice.git
Cloning into 'git_practice'...
remote: Enumerating objects: 28, done.
remote: Counting objects: 100% (28/28), done.
remote: Compressing objects: 100% (16/16), done.
remote: Total 28 (delta 5), reused 12 (delta 1), pack-reused 0
Receiving objects: 100% (28/28), 4.57 KiB | 212.00 KiB/s, done.
Resolving deltas: 100% (5/5), done.
```



## Merge

merge ç”¨äºåˆå¹¶ã€‚merge çš„æ–¹å¼æœ‰å„ç§å„æ ·ï¼Œä½†åœ¨ feature åˆ†æ”¯åˆå¹¶åˆ° master/main ä¸»åˆ†æ”¯æ—¶ï¼Œmerge è¯·æ±‚å¾€å¾€éœ€è¦ç®¡ç†å‘˜åŒæ„ï¼Œæ­¤æ—¶çš„ merge æ˜¯å•çº¯çš„æŒ‰é’®ï¼Œè€Œä¸æ˜¯å…·ä½“çš„å‘½ä»¤ï¼Œå› æ­¤è¯¥ action éœ€è¦é€‰æ‹©ã€‚

å¸¸è§çš„ options æœ‰ï¼š[^4]

1. `merge `
2. `rebase && merge --ff-only` çº¿æ€§ (linear)
3. `rebase && merge --no-ff` åŠçº¿æ€§çš„ (semi-linear)

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131859212.png)`ff` å…¨ç§° fast forwardï¼Œå½“ç¦æ­¢ fast forward åï¼Œå°†ä¼šäº§ç”Ÿä¸€ä¸ªåˆå¹¶è®°å½•ã€‚é»˜è®¤ä¼¼ä¹æ˜¯ fast forward æ¨¡å¼ã€‚[^5] åœ¨æäº¤ pull request ä¹‹åï¼Œå¯ä»¥çœ‹è§è¯¥ optionsã€‚

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131859368.png)ç›¸å…³è®¨è®ºï¼š

- [Why does git perform fast-forward merges by default?](https://stackoverflow.com/questions/2850369/why-does-git-perform-fast-forward-merges-by-default)



## Pull Request (PR)

**pull request** æŒ‡çš„å‘ŠçŸ¥ä»–äººä½ å·²ç»ä¿®æ”¹äº†ä¸€äº›ä¸œè¥¿ï¼Œç­‰ä»–äººè®¨è®ºå’Œ review å®Œåï¼Œå°±å¯ä»¥ merge åˆ° base åˆ†æ”¯ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯ merge remote åˆ†æ”¯ã€‚GitHub ç°åœ¨æä¾›äº†ä¸¤ç§æ–¹å¼ã€‚[^6]

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131905577.png)



## Rebase

ä½¿ç”¨ `git rebase` å¯ä¼šä¿®æ”¹æœ¬åœ° commit çš„ base ä½ç½®ã€‚å›¾æº[^3] 

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131902542.png)

ç”±äº Rebase æ˜¯<div class='sup' data-title="åœ¨æ“ä½œåå¾€å¾€éœ€è¦ä½¿ç”¨ git push --force">ç ´åæ€§æ“ä½œ</div>ï¼Œæ‰€ä»¥ä¸åº”ä½¿ç”¨åœ¨ master/main åˆ†æ”¯ã€‚

å½“æƒ³è¦åœ¨ master/main åˆ†æ”¯è¾¾åˆ° rebase feature åˆ†æ”¯çš„æ•ˆæœï¼Œå¯ä»¥é€‰æ‹©

- å…ˆ squash commitsï¼Œç„¶å merge/rebase
- å…ˆ squash commitsï¼Œç„¶å cherry-pick

ä»¥ä¿è¯å†å²æ¸…æ™°ï¼Œä»¥åŠä¸æ˜¾å¾—çªå…€ã€‚

ç›¸å…³è®¨è®ºï¼š

- [ä¸ºä»€ä¹ˆä½ åº”è¯¥åœæ­¢ä½¿ç”¨ Git rebase å‘½ä»¤](https://zhuanlan.zhihu.com/p/29682134) çš„åŸæ–‡ä»¥åŠè¯„è®ºã€‚
- [Why you should stop using Git rebase](https://medium.com/@fredrikmorken/why-you-should-stop-using-git-rebase-5552bee4fed1) çš„åŸæ–‡ä»¥åŠ Responses ã€‚



## å›æ»š Rollback



### Reset

ä½¿ç”¨ reset å¯ä»¥å›æ»šåˆ†æ”¯åˆ°æŸä¸ªçŠ¶æ€ã€‚reset æœ‰ä¸‰ç§é€‰ optionsï¼š[^7]

- soft (å¸¸ç”¨)
- mixed
- hard (å¸¸ç”¨)

### ![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131900614.jpg)

### å›æ»šæ–‡ä»¶ Rollback Files

æ ¹æ® [How can I reset or revert a file to a specific revision?](https://stackoverflow.com/questions/215718/how-can-i-reset-or-revert-a-file-to-a-specific-revision)  ä¸€è´´ï¼Œå¤§è‡´æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š

1. reset
2. revert
3. checkout

ç”±äº Jetbrain æä¾›çš„å›æ»šåŠŸèƒ½ååˆ†æ–¹ä¾¿ï¼Œå› æ­¤ä¸å¯¹è¯¥è¯é¢˜è¿›è¡Œè®¨è®ºã€‚è€Œå°†å†å²æ–‡ä»¶å¯¼å‡ºçš„è¿™ç§ç‰¹æ®Šéœ€æ±‚ï¼Œåˆ™å¯ä½¿ç”¨ checkoutã€‚

![](https://raw.githubusercontent.com/caliburn1994-2/caliburn1994-image/main/images/202202131900314.png)



## é…ç½® config

```bash
git config --list # åˆ—å‡ºå½“å‰é…ç½®
git config --global user.name â€œ[firstname lastname]â€
git config --global user.email â€œ[valid-email]â€
```



## Commit message

æ ‡ç­¾ğŸ·

```bash
feat: åŠŸèƒ½
fixï¼š ä¿®å¤bug
docs: æ–‡æ¡£ã€readme.md
style: ä»£ç æ ¼å¼ï¼Œå¦‚: tabã€ç©ºæ ¼ã€ç«è½¦ç­‰
refactor: é‡æ„
test: ä¸€åˆ‡ä¸æµ‹è¯•ç›¸å…³å¾—
chore: æ‚åŠ¡ã€‚å¦‚ï¼šæ›´æ–°CICDä»£ç ï¼Œéƒ¨ç½²ä»£ç ç­‰ç­‰
```

ç›¸å…³çš„ç°æˆæ’ä»¶

- [Git Commit Message Helper](https://plugins.jetbrains.com/plugin/13477-git-commit-message-helper)

**TODO**

- éœ€è¦å¯»æ‰¾ç°æˆè§„èŒƒ https://gist.github.com/joshbuchea/6f47e86d2510bce28f8e7f42ae84c716 
- https://towardsdatascience.com/automating-version-tags-and-changelogs-for-your-python-projects-6c46b68c7139
- https://medium.com/@jsilvax/automate-semantic-versioning-with-conventional-commits-d76a9f45f2fa
- https://github.com/lppedd/idea-conventional-commit/blob/master/README.md



## å…¶ä»– Others

- ä½¿ç”¨ `git commit --amend` å¯ä»¥è¦†ç›–ä¸Šä¸€ä¸ªè¯·æ±‚

- `git stash` å’Œ IntelliJ IDEA çš„ Shelve Changes éƒ½å¯ä»¥å°† changes æ”¶èµ·æ¥ï¼Œè¦ç”¨æ—¶å€™å†æ¢å¤ã€‚ï¼ˆä¸ªäººæ¨è IDEA çš„ï¼‰[^2]

  > The stolen pictures were **stashed** (away) in a warehouse.
  > å¤±ç«Šçš„ç•«è¢«**è—åŒ¿**åœ¨ä¸€å€‹å€‰åº«è£¡ã€‚
  >
  > I've had to **shelve** my plans to buy a new car, because I can't afford it at the moment.
  > æˆ‘ä¸å¾—ä¸**å»¶ç·©**è²·æ–°è»Šçš„è¨ˆåŠƒï¼Œå› çˆ²ç›®å‰æˆ‘é‚„è²·ä¸èµ·ã€‚

- `git squash` å¯ä»¥å‹ç¼© commitsã€‚

  > The room was so full you couldn't **squash** another person in.
  > æˆ¿é–“è£¡æ“ å¾—æ»¿æ»¿çš„ï¼Œå†ä¹Ÿ**æ“ **ä¸é€²ä¸€å€‹äººäº†ã€‚

- `git cherry-pick`  å°†å…¶ä»–åˆ†æ”¯çš„ commit å¤åˆ¶åˆ°å½“å‰åˆ†æ”¯ä¸Šã€‚

- `git push --force` è¦†ç›–å½“å‰åˆ†æ”¯

- `git pull` = `git fetch` + `git merge`ã€‚ `git fetch` å¯ä»¥æ›´æ–°æœ¬åœ°çš„è¿œç¨‹åˆ†æ”¯å†å²ã€‚



## å»¶ä¼¸é˜…è¯» See Also

- [GIT CHEAT SHEET - GitHub Education](https://education.github.com/git-cheat-sheet-education.pdf)
- [Hello World - GitHub Guides](https://guides.github.com/activities/hello-world/)  Github ç¤ºä¾‹
- [Understanding the GitHub flow](https://guides.github.com/introduction/flow/) merge æµç¨‹çš„ç¤ºä¾‹



[^1]: [Remove credentials from Git](https://stackoverflow.com/questions/15381198/remove-credentials-from-git)

[^2]: [Git Stash vs Shelve in IntelliJ IDEA](https://stackoverflow.com/questions/28008139/git-stash-vs-shelve-in-intellij-idea)
[^3]: https://cloudaffaire.com/git-branching-and-rebasing/
[^4]: [Support semi-linear merge option for pull requests](https://github.com/isaacs/github/issues/1017)
[^5]: [Why does git perform fast-forward merges by default?](https://stackoverflow.com/questions/2850369/why-does-git-perform-fast-forward-merges-by-default)
[^6]: [About pull requests - GitHub Docs](https://docs.github.com/en/github/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests)
[^7]: [What's the difference between git reset --mixed, --soft, and --hard?](https://stackoverflow.com/questions/3528245/whats-the-difference-between-git-reset-mixed-soft-and-hard/3528483#3528483)







