---
layout: post
title: Java密码学 - 6. 对称加密
date: 2017-07-30 22:10:54
categories: 计算机
tags: 安全 
comments: 1
---


DES的算法相对比较简单. (DES算法已经不被推荐了)[1] 一般使用AES

JCE的实现如下  

```
Cipher desCipher;
desCipher = Cipher.getInstance("DES/ECB/PKCS5Padding");//设置算法与模式
desCipher.init(Cipher.ENCRYPT_MODE, 密钥);//加载密钥, 设置为加密模式
byte[] textEncrypted = desCipher.doFinal(text);//得到原文
```



BC作为提供者, 这里只需要这样既可

```
Security.addProvider(new BouncyCastleProvider());
Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding","BC");
```





传送门:[How to encrypt and decrypt files with bouncy castle (DES) in netbeans java?](https://stackoverflow.com/questions/20452880/how-to-encrypt-and-decrypt-files-with-bouncy-castle-des-in-netbeans-java) 


注意:

我们可以使用update进行加载数据, 最后才使用doFinal, doFinal会使用到padding进行填充 (如 PKCS5padding)

cipher在进行大数据的处理时候, 需要分块处理, 此时需要用到update不断循环处理, 最终才进行doFinal


```
Cipher = Cipher.getInstance("DES/ECB/PKCS5Padding");//设置算法与模式
Cipher.init(Cipher.ENCRYPT_MODE, 密钥);//加载密钥, 设置为加密模式
while(...){
byte[] data=Cipher.update(数据)
}
byte[] data=cipher.dofinal();
```

---
##### **模式**

当选择CBC模式, 就需要iv值 *initialization vector* , 给我感觉就有点像 摘要算法加盐

iv理应是字节组, 可是这里却是一个对象. 这让我感觉惊讶. 但如果是看了ASN.1格式的一些代码, 就明白, ANS.1格式代码的实现, 其不用byte[]等参数, 而是使用类来代替

```
byte[] iv = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};//要16位
IvParameterSpec ivspec = new IvParameterSpec(iv);
Cipher Cipher = Cipher.getInstance("DES/ECB/PKCS5Padding");
Cipher.init(Cipher.ENCRYPT_MODE, 密钥,ivspec);//在这里添加参数
byte[] textEncrypted = Cipher.doFinal(text);
```