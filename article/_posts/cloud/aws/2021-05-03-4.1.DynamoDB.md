---
layout: post
title: 4.1 DynamoDB
tags: [AWS]
comments: 1
typora-root-url: ../../../..
excerpt: 关于 AWS 的 DynamoDB 的笔记。
---









## partition key

根据 [Choosing the Right DynamoDB Partition Key](https://aws.amazon.com/cn/blogs/database/choosing-the-right-dynamodb-partition-key/) 描述，DynamoDB支持两种主键<sup>primary keys</sup>：

- Partition key
- composite primary key = (Partition Key , Sort Key)：相当于关系数据库的 <u>复合主键</u><sup>composite primary key</sup>，Sort Key 用于排序

DynamoDB 中，获取和存储数据是根据主键的键值</u>，该值必须是<u>唯一</u>的，该值分布在 10-GB storage units 里，这 10 GB 就叫 partitions。每一张表中有一个会有若干个 partitions。就像文章的图所示：

![img](/assets/blog_res/dynamodb-partition-key-2.gif)

DynamoDB 查找数据的过程是这样：

1. 将 partition 的键值作为输入参数，传给 <u>内部哈希函数</u><sup>internal hash function</sup>
2. <u>内部哈希函数</u><sup>internal hash function</sup> 计算出数据所在的 partition 以及位置。

另外，同一个 partition 的数据将存在一起，复合主键的情况，则会根据 sort key 进行排序。

### 如何选择 partition key

1. 尽可能选择键值是唯一的。这样可以使数据分布均匀
   - 尽量使 partition key 的访问次数均匀
2. 符合键，或者查询时会使用多个键，可以考虑将其组合起来。如，把 `customerid+productid+countrycode` 作为 partition key 
3. 键值的生成不应该使用 auto increment，可能产生冲突

## 其他

- DynamoDB 可以结合 [Amazon DynamoDB Accelerator](https://aws.amazon.com/dynamodb/dax/) 使用
- 

### 练习题

A Developer is working on an application that tracks hundreds of millions of product reviews in an Amazon DynamoDB table. The records include the data elements shown in the table:

![img](/assets/blog_res/0000300001.png)

Which field, when used as the partition key, would result in the MOST <u>consistent performance</u> （安定的性能）using DynamoDB?

- A. starRating
- B. reviewID
- C. comment
- D. productID

题目出自：https://www.examtopics.com/exams/amazon/aws-certified-developer-associate/view/









